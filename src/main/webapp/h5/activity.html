<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>活动</title>
		<meta name="renderer" content="webkit">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="css/activity.css"/>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
	</head>
	<body>
		<div class="act_ban_contianer">
			<img class="act_banner" src="img/act_banner.png"/>
		</div>
		<div class="wrap">
			<div class="act_amount_container">
				<button>兑换</button>
				<span class="card">100元话费充值卡</span>
				<span class="fr"><em id="unitPrice"></em>&nbsp;U币</span>
			</div>
			<div class="act_show">
				<ul>
					<li><i class="icon_xu"></i><span>虚拟物品</span></li>
					<li><i class="icon_zi"></i><span>自动兑换</span></li>
					<li><i class="icon_shi"></i><span>1~3天到账</span></li>
				</ul>
				<p>温馨提示：1、兑换成功后，工作人员会于1-3个工作日内将商品审核通过。2、若在兑换过程中有任何问题，可联系微信客服或者拨打客服电话。</p>
			</div>
		</div>
		<div class="module_gap"></div>
		<div class=" exchange wrap ">
			<div class="number">
				<span class="title">兑换数量:</span>
				<button onclick="minus()" class="minus">-</button>
				<input type="text" id="exchangeAmount" onblur="onBlur()" value="1" class="text" />
				<button onclick="plus()" class="plus">+</button>
			</div>
			<div class="con">
				<span class="black-c">U币:</span>
				<span class="conNumber"></span>
				<span class="alert" style="display: none;">U币不足</span>
			</div>
		</div>
		
		<div class="module_gap"></div>
		<div class="exchange_intro">
			<div class="intro_title"><span>兑换说明</span></div>
			<div class="wrap intro_list">
				<p class="text_title">1、兑换成功后： </p>
				<p >客服会在1-3个工作日内完成充值或邮寄。</p>
				<p class="text_title">2、虚拟商品：</p>
				<p >兑换成功后，客服会直接联系你核对充值号码，不可更换手机号码。运营商系统异常情况下，会出现延迟到帐，具体到账时间以运营商系统缴费时间为准。</p>
				<p class="text_title"> 3、实物商品：</p>
				<p >邮寄前会通过电话方式与您联系核对收货地址及收货人电话。届时，您可在“我的兑换”里面查询您的兑换记录。说明：实物商品请兑换前请进行实名认证。</p>
			</div>
		</div>
		<div class="footer">
			<button>现有U币: <em id="conAmount"></em></button>
			<button onclick="goExchage()">立即兑换</button>
		</div>
		<!--窗口1-->
		<div id="model1" class="model" style="display: none;">
			<i class="back_icon"></i>
			<h3>U币不足，无法兑换</h3>
			<h5>您可以参加比赛获取更多U币</h5>
			<div class="btnBox">
				<button>确定</button>
			</div>
		</div>
		<!--窗口2-->
		<div id="model2" class="model"style="display: none;">
			<i class="back_icon"></i>
			<h3 style="margin-top: 35px;">请先完成实名认证</h3>
			<div class="btnBox" style="margin-top: 25px ;">
				<button>确定</button>
			</div>
		</div>
		<!--窗口3-->
		<div id="model3" class="model" style="display: none;">
			<i class="back_icon"></i>
			<h3>充值手机号：</h3>
			<div class="iptBox">
				<div style="position: relative;">
					<i id="clearBtn"></i>
					<input id="phoneNumber" maxlength="11" type="text" name="" id="" value="" />
				</div>
				<p class="error">号码不正确</p>
			</div>
			<div class="btnBox">
				<button onclick="validatemobile()" >确定</button>
			</div>
		</div>
		<!--窗口4-->
		<div id="model4" class="model"  style="display: none;">
			<i class="back_icon"></i>
			<h3>姓名：&nbsp;<span>谢磊1</span></h3>
			<div class="iptBox">
				<textarea placeholder="默认使用奖品发送地址，没有的话需要客户填写，同时在确定前允许客户修改" name="" rows="3" cols="34"></textarea>
			</div>
			<div class="btnBox">
				<button>确定</button>
			</div>
		</div>
		<div class="coverlayer" style="display: none;">
		</div>
		<script type="text/javascript">
			//现有金币
			var conAmount = 1000000;
			$('#conAmount').text(toThousands(conAmount));
			//货物单价
			var unitPrice = 10000;
			$('#unitPrice').text(toThousands(unitPrice));
			$('.conNumber').text(toThousands(unitPrice));
			function minus(){
				var exchangeAmount = $('#exchangeAmount').val();
				if(exchangeAmount!=''&&exchangeAmount>0){
					exchangeAmount--;
					$('#exchangeAmount').val(exchangeAmount);
				}
				var conNumber = unitPrice*exchangeAmount;
				$('.conNumber').text(toThousands(conNumber));
				uCon();
			}
			function plus(){
				var exchangeAmount = $('#exchangeAmount').val();
				if(typeof(exchangeAmount)!='undefined'){
					exchangeAmount++;
					$('#exchangeAmount').val(exchangeAmount);
				}else{
					exchangeAmount=0;
					exchangeAmount++;
					$('#exchangeAmount').val(exchangeAmount);
				}
				var conNumber = unitPrice*exchangeAmount;
				$('.conNumber').text(toThousands(conNumber));
				uCon();
			}
			//千位符格式转换
			function toThousands(num) {
			    var result = [ ], counter = 0;
			    num = (num || 0).toString().split('');
			    for (var i = num.length - 1; i >= 0; i--) {
			        counter++;
			        result.unshift(num[i]);
			        if (!(counter % 3) && i != 0) { result.unshift(','); }
			    }
			    return result.join('');
			}
			
			//输入框失去焦点事件
			function onBlur(){
				var exchangeAmount = $('#exchangeAmount').val();
				if(exchangeAmount=='undefined'){
					exchangeAmount =0;
				}
				var conNumber = unitPrice*exchangeAmount;
				$('.conNumber').text(toThousands(conNumber));
				uCon();
			}
			//u币不足
			var a = '100,000,000';
			var c = a.split(',');
			var b = c.join('');
			function uCon(){
				var a = $('.conNumber').text();
				var b =parseInt( a.split(',').join('') ) ;
				if(b>conAmount){
					$('.alert').show();
				}else{
					$('.alert').hide();
				}
			}
			uCon();
			function goExchage(){
				//余额不足
//				if(false){
//					$('.coverlayer').show();
//					$('#model1').show();
//				}
				//没有实名认证
//				if(true){
//					$('.coverlayer').show();
//					$('#model4').show();
//				}
				
			}
			$('.back_icon').click(function(){
				$(this).parent().hide();
				$('.coverlayer').hide();
			})
			//表单验证
			function validatemobile() 
			   { 
			   	var mobile = $('#phoneNumber').val();
			       if(mobile.length==0) { 
			         $('.iptBox .error').html('请输入手机号码！'); 
			         $('.iptBox .error').css('visibility','visible')
			          $(this).focus(); 
			          return false; 
			       }     
			       if(mobile.length!=11) 
			       { 
			         $('.iptBox .error').html('请输入有效的手机号码！'); 
			         $('.iptBox .error').css('visibility','visible')
			          $(this).focus(); 
			           return false; 
			       } 
			       var myreg = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/; 
			       if(!myreg.test(mobile)) 
			       { 
			           $('.iptBox .error').html('请输入有效的手机号码！'); 
			           $('.iptBox .error').css('visibility','visible')
			           $(this).focus(); 
			           return false; 
			       } 
			       $('.iptBox .error').html('请输入有效的手机号码！'); 
			       return true;
			       $('.iptBox .error').css('visibility','hidden')
			   } 
			$('#clearBtn').click(function(){
				$('#phoneNumber').val('');
				  $('.iptBox .error').css('visibility','hidden')
			})
		</script>
	</body>
</html>
